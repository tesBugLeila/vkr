<section class="notifications">
  <div class="notifications-header">
    <h2>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h2>
    <a [routerLink]="['/']" class="back-link">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
  </div>

  <div class="notifications-actions">
    <button 
      [class.active]="showOnlyUnread" 
      (click)="toggleFilter()"
      class="filter-btn"
    >
      {{ showOnlyUnread ? '–í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è' : '–¢–æ–ª—å–∫–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ' }}
    </button>

    @if (hasUnreadNotifications) {
      <button (click)="markAllAsRead()" class="mark-all-btn">
        ‚úì –û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
      </button>
    }
  </div>

  @if (loading) {
    <app-loading></app-loading>
  }

  @if (!loading && notifications.length === 0) {
    <div class="empty-state">
      <div class="empty-icon">üîî</div>
      <p>{{ showOnlyUnread ? '–ù–µ—Ç –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π' : '–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π' }}</p>
      <p class="empty-hint">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è, –∫–æ–≥–¥–∞ —Ä—è–¥–æ–º —Å –≤–∞–º–∏ –∫—Ç–æ-—Ç–æ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–µ</p>
    </div>
  }

  @if (!loading && notifications.length > 0) {
    <div class="notifications-list">
      @for (notification of notifications; track notification.id) {
        <div 
          class="notification-card" 
          [class.unread]="!notification.isRead"
          (click)="markAsRead(notification)"
        >
          <div class="notification-content">
            @if (!notification.isRead) {
              <div class="unread-indicator"></div>
            }

            <div class="notification-icon">
             @if (notification.post && notification.post.photos && notification.post.photos.length > 0) {
  <img [src]="notification.post.photos[0]" [alt]="notification.postTitle" />
}
               @else {
                <div class="icon-placeholder">üîî</div>
              }
            </div>

            <div class="notification-body">
              <div class="notification-title">
                <strong>–ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ —Ä—è–¥–æ–º —Å –≤–∞–º–∏!</strong>
              </div>
              
              <div class="notification-text">
                <a [routerLink]="['/post', notification.postId]" class="post-link">
                  {{ notification.postTitle }}
                </a>
              </div>

              @if (notification.post) {
                <div class="notification-details">
                  <span class="category">{{ notification.post.category }}</span>
                  <span class="price">{{ notification.post.price }} ‚ÇΩ</span>
                </div>
              }

              <div class="notification-meta">
                <span class="distance">üìç {{ formatDistance(notification.distance) }} –æ—Ç –≤–∞—Å</span>
                <span class="time">{{ notification.createdAt | parseDateTime | dateAgo }}</span>
              </div>
            </div>

            <div class="notification-actions">
              <button 
                class="delete-btn" 
                (click)="deleteNotification(notification.id); $event.stopPropagation()"
                title="–£–¥–∞–ª–∏—Ç—å"
              >
                üóëÔ∏è
              </button>
            </div>
          </div>
        </div>
      }
    </div>
  }
</section>